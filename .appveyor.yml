shallow_clone: true

image: Visual Studio 2013
platform:
  - x86
  - x64

environment:
  matrix:
    - VSVER: 12

install:
  - ps: >-
      If ($env:Platform -Match "x86") {
          $env:VCVARS_PLATFORM="x86"
          $env:MARCH=""
          $env:BUILD="x86-pc-cygwin"
          $env:HOST="x86-pc-winnt"
        } Else {
          $env:VCVARS_PLATFORM="amd64"
          $env:MARCH="-m64"
          $env:BUILD="x86_64-pc-cygwin"
          $env:HOST="x86_64-pc-winnt"
      }
  - ps: $env:VSCOMNTOOLS=(Get-Content ("env:VS" + "$env:VSVER" + "0COMNTOOLS"))
  - echo "Using Visual Studio %VSVER%.0 at %VSCOMNTOOLS%"
  - call "%VSCOMNTOOLS%\..\..\VC\vcvarsall.bat" %VCVARS_PLATFORM%

build_script:
  - c:\cygwin\bin\sh -lc "env"
  - set
  - c:\cygwin\bin\sh -lc "which cl"
  - c:\cygwin\bin\sh -lc "which cl.exe"
  - c:\cygwin\bin\sh -lc "which ml64"
  - c:\cygwin\bin\sh -lc "which ml64.exe"
  - c:\cygwin\bin\sh -lc "(cd $OLDPWD; ./autogen.sh;)"
  - c:\cygwin\bin\sh -lc "(cd $OLDPWD; ./configure CC='/cygdrive/c/projects/libffi/msvcc.sh -m64' CXX='/cygdrive/c/projects/libffi/msvcc.sh $MARCH' LD=link CPP='cl -nologo -EP' --build=$BUILD --host=$HOST; cp src/x86/ffitarget.h include; make)"
  




  
  

  

  
  

  
  

